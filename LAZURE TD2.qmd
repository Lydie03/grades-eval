---
title: "Lazure - graded lab2"
format: html
---

## Loading the dataset

```{r}
library(dplyr)
library(tidyr)
library(tidyverse)
library(ggplot2)
```
```{r}
data_set <- read.csv("C:/Users/lydie/Downloads/grades (1).csv")
```

## Simple analysis

#2
The data set contains `length(data_set$grade)`grades. 

#3
```{r}
data_set %>% distinct(id) %>% count()
```

There are `data_set %>% distinct(id) %>% count()`students in the dataset. 

#4
```{r}
students <- data_set %>%
  distinct(id, .keep_all = TRUE) %>%  
  select(id = id, group = group)  

head(students)
```

#5
```{r}
ggplot(data = students, aes(x = group)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "Number of Students per Group", x = "Group", y = "Number of Students") +
  theme_minimal()
```

#6

```{r}
post_apocalyptic_data <- data_set %>%
  filter(course == "Post-Apocalyptic History and Archaeology")

average_grades <- post_apocalyptic_data %>%
  group_by(group) %>%
  summarise(avg_grade = mean(grade, na.rm = TRUE))

ggplot(data = average_grades, aes(x = group, y = avg_grade)) +
  geom_col(fill = "skyblue", color = "black") +
  labs(title = "Average Grades in Post-Apocalyptic History and Archaeology by Group", x = "Group", y = "Average Grade") +
  theme_minimal()
```
#7

```{r}
average_grades <- post_apocalyptic_data %>%
  group_by(trimester) %>%
  summarise(avg_grade = mean(grade, na.rm = TRUE))

ggplot(data = average_grades, aes(x = as.factor(trimester), y = avg_grade, fill = as.factor(trimester))) +
  geom_bar(stat = "identity", position = "dodge", color = "black") +
  labs(title = "Average Grades in Post-Apocalyptic History and Archaeology by Trimester",
       x = "Trimester", y = "Average Grade") +
  theme_minimal()
```

## Attendance analysis

#8
```{r}
library(knitr)
grades_per_student <- data_set %>%
  distinct(id, .keep_all = TRUE) %>% 
  group_by(id) %>%
  summarise(
    min_grade = min(grade, na.rm = TRUE),
    max_bpm = max(grade, na.rm = TRUE),
    mean_bpm = mean(grade, na.rm = TRUE),
    median_bpm = median(grade, na.rm = TRUE),
    grades_count = n()
  )

grades_per_student

knitr::kable(grades_per_student, format = "markdown")
```

#9
```{r}
grades_per_student_SSWM <- data_set %>%
  filter(course=="Survival Skills and Wilderness Medicine") %>%
  group_by(id, group) %>%
  summarise(num_grades = n())

head(grades_per_student_SSWM)
```
#10
```{r}
same_num_grades_count <- grades_per_student_SSWM %>%
  group_by(num_grades) %>%
  summarise(num_students = n()) %>%
  filter(num_students > 1)  

ggplot(same_num_grades_count, aes(x = num_grades, y = num_students)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(title = "Number of Students with the Same Number of Grades",
       x = "Number of Grades",
       y = "Number of Students") +
  theme_minimal()

same_num_grades_count
```

#11

```{r}
ggplot(grades_per_student_SSWM, aes(x = group, y = num_grades, fill = group)) +
  geom_point() 
```
There does not seem to be a clear pattern between the two variables. 
